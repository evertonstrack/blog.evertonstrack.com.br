<script type="text/javascript">
  const html = document.querySelector("html");
  const metaTheme = document.querySelector('meta[name=theme-color]');
  const isPreferredThemeDark = window.matchMedia('(prefers-color-scheme: dark)');
  const themes = {
    light: {
      background: '#FDFDFD',
      background_alt: 'rgba(218, 214, 214, 0.3)',
      text: '#25262a',
    },
    dark: {
      background: '#25262a',
      background_alt: 'rgba(218, 214, 214, 0.1)',
      text: '#FFFFFF',
    }
  };

  // Change colors
  function changeColors(newTheme) {
    const themeColors = themes[newTheme];

    Object.keys(themeColors).map(function(key) {
      html.style.setProperty(`--${key}`, themeColors[key]);
    });

    metaTheme.setAttribute('content', themeColors['background']);
  }

  // Set Theme
  function setTheme(newTheme) {
    changeColors(newTheme);
    window.__userTheme = newTheme;
  }

  // Change theme when user change in the OS
  isPreferredThemeDark.addListener(function(event) {
    setTheme(event.matches ? 'dark' : 'light');
    themeToggle.checked = event.matches ? true : false;
  });

  // Se existe um tema salvo, seta esse tema, caso contrário, pega o tema do sistema do usuário
  window.__userTheme = localStorage.getItem('user-theme') || isPreferredThemeDark.matches ? 'dark' : 'light';
  setTheme(window.__userTheme);
</script>
